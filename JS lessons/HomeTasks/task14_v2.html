<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>editable list</title>
    <style>
        * {
        box-sizing: border-box;
        color: black;
        }
        form .input-text-main::placeholder {
            color:rgba(79, 87, 100, 0.7); 
        }
        form input:hover {
            box-shadow: 0 0 0 2px blue;
        }
        input[type='button']:hover {
            box-shadow: 0 0 0 2px blue;
        }
        input[type='button']:active {
            box-shadow: 0 0 0 2px blue;
        }
        input[type='button']:disabled {
            box-shadow: 0 0 0 2px rgb(205, 205, 220);
            color:rgb(205, 205, 220);
            border: none;
        }
    
    </style>
</head>
<body>
    
<script>

const items = ['Пункт 1','Пункт 2','Пункт 3','Пункт 4','Пункт 5'];

const createList = function(array) {
    const readyList = document.createElement('ol');
    document.body.prepend(readyList);
    readyList.style.cssText = `margin: 50px 0 25px 100px; padding: 0;`;
    array.forEach(item => {
        const readyListItem = document.createElement('li');
        readyListItem.textContent = item;
        readyList.append(readyListItem);
        readyListItem.style.cssText = `font-size: 21px; margin-bottom: 15px; cursor: pointer;`;
    });
}
createList(items);

const inputForm = document.createElement('form');
inputForm.style.cssText = `margin-left: 80px`;
const textInput = document.createElement('input');
textInput.setAttribute('type', 'text');
textInput.setAttribute('name', 'inptext');
inputForm.append(textInput);
textInput.style.cssText = `margin: 10px 35px 25px 0;
                        padding: 8px 15px;
                        border-radius: 8px;
                        border: 1px solid black;
                        outline: none;
                        cursor: text;`;
const btnInput = document.createElement('input');
btnInput.setAttribute('type', 'button');
btnInput.setAttribute('name', 'inpbtn');
btnInput.value = 'Add';
inputForm.append(btnInput);
btnInput.style.cssText = `padding: 10px 17px;
                        border-radius: 10px;
                        border: 2px solid black;
                        font-size: 16px;
                        transition: all 0.5s ease;
                        cursor: pointer;
                        margin-right: 10px;`;
                        
document.querySelector('ol').after(inputForm);

const deleteBtnInput = document.createElement('input');
deleteBtnInput.setAttribute('type', 'button');
deleteBtnInput.value = 'Remove';
deleteBtnInput.style.cssText = `padding: 10px 17px;
                                border-radius: 10px;
                                border: 2px solid black;
                                font-size: 16px;
                                transition: all 0.5s ease;
                                cursor: pointer;
                                margin-right: 10px;`;
document.forms[0].append(deleteBtnInput);


let isClickedAddBtn = false;
const addItemInReadyList = () => {
  if ((!isClickedAddBtn || isClickedAddBtn) && document.forms[0].inptext.value.length > 0) {
    (document.querySelector('ol').children.length === 0 && (document.forms[0].inptext.value.length !== 0)) && document.querySelectorAll('input[type="button"]')[1].removeAttribute('disabled');
    if (document.forms[0].inptext.value.length > 0) {
      const newReadyListItem = document.createElement('li');
      newReadyListItem.classList.add('note');
      newReadyListItem.textContent = document.forms[0].inptext.value;
      document.querySelector('ol').append(newReadyListItem);
      newReadyListItem.style.cssText = `font-size: 21px; margin-bottom: 15px; cursor: pointer;`
      document.forms[0].inptext.value = '';
      document.forms[0].inptext.placeholder = 'Введите значение';
      newReadyListItem.addEventListener('click', changeInfoInReadyListItem, {once: true});
    }
  return;
  } else if (!isClickedAddBtn) {
      document.forms[0].inptext.placeholder = 'Введите значение';
      isClickedAddBtn = true;
      return;
    }
}

document.forms[0].inpbtn.addEventListener('click', addItemInReadyList);

const removeItemFromReadyList = () => {
  if (document.querySelector('ol').children.length < 0) {
    return;
  } else {
    if (document.querySelector('ol').children.length > 1) {
      document.querySelector('ol').lastElementChild.remove();
    } else if (document.querySelector('ol').children.length === 1) {
      document.querySelector('ol').lastElementChild.remove();
      document.querySelectorAll('input[type="button"]')[1].setAttribute('disabled', 'disabled');
    }
  }
}
document.querySelectorAll('input[type="button"]')[1].addEventListener('click', removeItemFromReadyList);

const addHandlersToReadyListItems = () => {
  [...document.getElementsByTagName('li')].forEach(item => item.addEventListener('click', changeInfoInReadyListItem, {once: true}));
}
addHandlersToReadyListItems()

function changeInfoInReadyListItem(event) {
  const listItemInput = document.createElement('input');
  listItemInput.setAttribute('type', 'text');
  listItemInput.setAttribute('name', 'litext');
  listItemInput.setAttribute('value', event.target.textContent); 
  event.target.innerHTML = `${listItemInput.outerHTML}`; 
  event.target.firstElementChild.addEventListener('focus', setCaretPositionOnFocus);
  event.target.firstElementChild.focus();
  event.target.firstElementChild.addEventListener('blur', saveInfoInReadyListItem);
}

function saveInfoInReadyListItem(event) {
  let targetParent = event.target.parentElement;
  event.target.parentElement.textContent = event.target.value;
  targetParent.addEventListener('click', changeInfoInReadyListItem, {once: true});
}

function setCaretPositionOnFocus(event) {
  event.target.selectionStart = event.target.selectionEnd = event.target.value.length;
}

</script>


</body>
</html>