<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    

<script>
    document.body.style.margin = 0;
document.body.style.padding = 0;
 let myInterval;


function createPingPong(){
   
    let wrapperDiv = document.createElement(`div`);
    wrapperDiv.setAttribute("id", "wrapperDiv");
    wrapperDiv.style.cssText = 'width: 800px; height: 760px; background-color: white; position: relative';
    document.body.append(wrapperDiv);


    let fieldParameters = {
        "x" : 0,
        "y" : 150,
        "width" : 790,
        "height" : 400,
        "color" : "yellow",
        "id" : "field",
        "zIndex" : "2",
        "borderWidth" : 5,
        "borderColor" : "black",
        "borderRadius" : "0",
        "borderStyle" : "solid"
    };
    let field = new CreateElem(fieldParameters);
    field.createObj();

    let racketLeftParameters = {
        "x" : 5,
        "y" : 375,
        "width" : 20,
        "height" : 150,
        "color" : "green",
        "id" : "racketLeft",
        "zIndex" : "3",
        "borderWidth" : 0,
        "borderColor" : "green",
        "borderRadius" : "0",
        "borderStyle" : "solid"
    };
    let racketLeft = new CreateElem(racketLeftParameters);
    racketLeft.createObj();

    let racketRightParameters = {
        "x" : 775,
        "y" : 375,
        "width" : 20,
        "height" : 150,
        "color" : "blue",
        "id" : "racketRight",
        "zIndex" : "3",
        "borderWidth" : 0,
        "borderColor" : "blue",
        "borderRadius" : "0",
        "borderStyle" : "solid"
    }
    let racketRight = new CreateElem(racketRightParameters);
    racketRight.createObj();

    racketLeft.scores = 0;
    racketRight.scores = 0;
    racketLeft.vY = 0;
    racketRight.vY = 0;

    let ballParameters = {
        "x" : 380,
        "y" : 430,
        "width" : 40,
        "height" : 40,
        "color" : "red",
        "id" : "ball",
        "zIndex" : "3",
        "borderWidth" : 0,
        "borderColor" : "red",
        "borderRadius" : "50%",
        "borderStyle" : "solid"
    }
    let ball = new CreateElem(ballParameters);
    ball.createObj();

    ball.vX = 2;
    ball.vY = 2;
    let bl = document.getElementById("ball");
    bl.style.display = 'none';

    let startButtonParameters = {
        "x" : 20,
        "y" : 40,
        "width" : 90,
        "height" : 30,
        "color" : "grey",
        "id" : "startButton",
        "zIndex" : "3",
        "borderWidth" : 0,
        "borderColor" : "grey",
        "borderRadius" : "0",
        "borderStyle" : "solid"
    }
    let startButton = new CreateElem(startButtonParameters);
    startButton.createObj();

    let titleButton = document.getElementById("startButton");
    titleButton.innerHTML = "СТАРТ!";
    titleButton.style.cursor = 'pointer';
    titleButton.style.color = 'black';
    titleButton.style.fontSize = '30px';
    titleButton.style.padding = '30px';

    let countParameters = {
        "x" : 320,
        "y" : 30,
        "width" : 135,
        "height" : 110,
        "color" : "white",
        "id" : "count",
        "zIndex" : "3",
        "borderWidth" : 0,
        "borderColor" : "white",
        "borderRadius" : "0",
        "borderStyle" : "solid"
    }
    let count = new CreateElem(countParameters);  
    count.createObj();

    let numbers = document.getElementById("count");
    numbers.innerHTML = racketRight.scores + ":" + racketLeft.scores;
    numbers.style.color = 'black';
    numbers.style.fontSize = '100px';

    addEventListener("keydown", movePlayers, false);
    addEventListener("keyup", stopPlayers, false);
    titleButton.addEventListener("click", start);

}


function CreateElem(objA){    
    let self = this;
    self.x = objA.x;
    self.y = objA.y;
    self.width = objA.width;
    self.height = objA.height;
    self.color = objA.color;
    self.id = objA.id;
    self.zIndex = objA.zIndex;
    self.borderWidth = objA.borderWidth;
    self.borderColor = objA.borderColor;
    self.borderRadius = objA.borderRadius;
    self.borderStyle = objA.borderStyle;
    self.createObj = function() {
        let wrapperDiv = document.getElementById('wrapperDiv');
        let crElem = document.createElement('div');
        crElem.style.cssText = 'position: absolute; left:' + self.x + 'px; top:' + self.y + 'px; width:' + self.width + 'px; height:' + self.height + 'px; background-color:' +  self.color + '; z-index:' + self.zIndex + '; border-width:' + self.borderWidth + 'px ; border-radius:' + self.borderRadius + '; border-color:' + self.borderColor + '; border-style:' + self.borderStyle;
        crElem.setAttribute('id', self.id);
        wrapperDiv.appendChild(crElem);
    }
    self.show = function() {
        let El = document.getElementById(this.id);
            El.style.top = (this.y + 'px');
            El.style.left = (this.x + 'px');
    }
}


function play(){
    draw();
    update();
}

function draw(){
    if(!ball.hiden){
        let bl = document.getElementById("ball");
            bl.style.display = 'block';
    }
    ball.show();
    racketRight.show();
    racketLeft.show();
    let sco = document.getElementById("count");
    sco.innerHTML = racketLeft.scores + ":" + racketRight.scores;

    if(racketLeft.stopInterval || racketRight.stopInterval){
        clearInterval(myInterval);
    }
}

function update(){
    ball.x += ball.vX;
    ball.y += ball.vY;
    racketLeft.y +=racketLeft.vY;
    racketRight.y +=racketRight.vY;
    //соприкосновение с горизонтальными стенками
        if (ball.y < field.y + field.borderWidth || ball.y + ball.height>field.y + field.height + field.borderWidth){
        ball.vY = -ball.vY;
        }
        //соприкосновение с левой стенкой
        if(ball.x<field.borderWidth){
        ball.vX = -ball.vX;
        racketRight.scores ++;
        racketRight.stopInterval = true;
        }
        //соприкосновение с правой стенкой
        if(ball.x + ball.width>field.x + field.width + field.borderWidth){
        ball.vX = -ball.vX;
        racketLeft.scores ++;
        racketLeft.stopInterval = true;
        }
        //столкновение с ракетками
        if((collision(racketLeft, ball)&&ball.vX<0)||(collision(racketRight, ball)&&ball.vX>0)){ball.vX=-ball.vX}
}

    function collision(objA, objB){
    if ((objA.x + objA.width > objB.x) && (objA.x < objB.x + objB.width) && (objA.y + objA.height > objB.y) && (objA.y < objB.y + objB.height)){ return true;}
    else {return false;}
}

function start(){
    racketLeft.y = field.y + field.height/2 - racketLeft.height/2;
    racketRight.y = field.y + field.height/2 - racketRight.height/2;
    racketLeft.scores;
    racketRight.scores;
    startBall();

    racketLeft.stopInterval = false;
    racketRight.stopInterval = false;
    myInterval = setInterval(play, 1000/50);
}


function startBall(){
    let min = 1;
    let max = 4;
    ball.x = 380;
    ball.y = 430;
    ball.hiden = false;

    let rand = Math.round(min - 0.5 + Math.random() * (max - min + 1));
    if ( rand == 1) 
    {ball.vX = -2;
        ball.vY = 2;
    }
    if ( rand == 2) 
    {ball.vX = -2;
        ball.vY = -2;
    }
    if ( rand == 3) 
    {ball.vX = 2;
        ball.vY = -2;
    }
    if ( rand == 4) 
    {ball.vX = 2;
        ball.vY = 2;
    }

}

function movePlayers(event){
    if (event.keyCode == 17){
        if (racketLeft.y < field.y + field.height - racketLeft.height + field.borderWidth){
            racketLeft.vY = 2;		    		
        } else {
            racketLeft.vY = 0;
        }
    }
    if (event.keyCode == 40){
        if (racketRight.y < field.y + field.height - racketRight.height + field.borderWidth){
            racketRight.vY = 2;		    		
        } else {
            racketRight.vY = 0;
        }
    }
    if (event.keyCode == 16){
        event.stopPropagation();
        if(racketLeft.y > field.y + field.borderWidth){
            racketLeft.vY = -2;
        } else {
            racketLeft.vY = 0;
        }
    }
    if (event.keyCode == 38){
        if(racketRight.y > field.y + field.borderWidth){
            racketRight.vY = -2;
        } else {
            racketRight.vY = 0;
        }
    }
}  

function stopPlayers(event){
        if (event.keyCode == 40 || event.keyCode == 38){
            racketRight.vY = 0;
        }
        if (event.keyCode == 17 || event.keyCode == 16){
            racketLeft.vY = 0;
        }
}  


createPingPong();


</script>    
</body>
</html>